import React, { useState, useEffect } from "react";
import { ArrowLeft, Save, Eye, Truck, CreditCard, MapPin, Clock, DollarSign } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { Badge } from "@/components/ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Separator } from "@/components/ui/separator";
import { Checkbox } from "@/components/ui/checkbox";
import { dummyCustomers } from "@/lib/dummyData";

const SaleOrderForm = ({ onSubmit, onCancel, initialData = null }) => {
  const generateOrderNumber = () => {
    return `SO${Math.floor(Math.random() * 90000) + 10000}`;
  };

  const [orderNumber] = useState(generateOrderNumber());
  const [activeTab, setActiveTab] = useState("lens-details");

  const [orderData, setOrderData] = useState({
    customer: "",
    customerRefNo: "",
    date: new Date().toISOString().split('T')[0],
    type: "",
    deliverySchedule: "",
    status: "Created",
    remark: "",
    itemRefNo: "",
    freeLens: false,
    // Lens Details
    lensName: "",
    category: "",
    lensType: "",
    dia: "",
    fittingType: "",
    coatingType: "",
    coatingName: "",
    tintingName: "",
    rightEye: true,
    leftEye: false,
    // Right Eye Specs
    rightSpherical: "-0.75",
    rightCylindrical: "0.00",
    rightAxis: "0",
    rightAdd: "1.25",
    rightDia: "70",
    rightBase: "RBASE",
    rightBaseSize: "PRISM",
    rightBled: "RNGH",
    // Left Eye Specs
    leftSpherical: "",
    leftCylindrical: "",
    leftAxis: "",
    leftAdd: "",
    leftDia: "",
    leftBase: "",
    leftBaseSize: "",
    leftBled: "",
    // Dispatch Fields
    dispatchStatus: "Pending",
    assignedPerson: "",
    dispatchId: "",
    estimatedDate: "",
    estimatedTime: "",
    actualDate: "",
    actualTime: "",
    dispatchNotes: "",
    // Billing Fields
    lensPrice: 0,
    coatingPrice: 0,
    fittingPrice: 0,
    tintingPrice: 0,
    discount: 0,
  });

  useEffect(() => {
    if (initialData) {
      setOrderData({ ...orderData, ...initialData });
    }
  }, [initialData]);

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="max-w-full mx-auto py-4 px-4">
        {/* Header */}
        <div className="flex items-center justify-between mb-4 bg-white rounded-lg shadow-sm p-4">
          <div className="flex items-center space-x-4">
            <h1 className="text-xl font-bold text-gray-900">Sales Order</h1>
            <div className="flex items-center space-x-2">
              <span className="text-xs text-gray-600">Order Number</span>
              <span className="font-semibold text-sm">{orderNumber}</span>
              <Badge variant="secondary" className="bg-green-100 text-green-800 text-xs">
                {orderData.status}
              </Badge>
            </div>
          </div>
          <div className="flex items-center space-x-3">
            <Button variant="outline" onClick={onCancel} className="flex items-center text-sm">
              <ArrowLeft className="h-3 w-3 mr-1" />
              Back
            </Button>
            <Button onClick={() => onSubmit(orderData)} className="bg-purple-600 hover:bg-purple-700 text-sm">
              <Save className="h-3 w-3 mr-1" />
              Save
            </Button>
          </div>
        </div>

        <div className="grid grid-cols-12 gap-4">
          {/* Left Panel - Order Information (35% width) */}
          <div className="col-span-4">
            <Card className="h-fit">
              <CardContent className="p-4 space-y-3">
                {/* Customer */}
                <div className="flex items-center gap-2">
                  <Label htmlFor="customer" className="text-sm font-medium text-gray-700 w-[120px]">Customer</Label>
                  <Select className="flex-1" value={orderData.customer} onValueChange={(value) => setOrderData({...orderData, customer: value, customerRefNo: Math.floor(Math.random() * 9000000) + 1000000})}>
                    <SelectTrigger className="flex-1">
                      <SelectValue placeholder="Select customer" />
                    </SelectTrigger>
                    <SelectContent>
                      {dummyCustomers.map((customer) => (
                        <SelectItem key={customer.id} value={customer.name}>
                          {customer.name}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>

                {/* Customer Ref No */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Customer Ref No</Label>
                  <Input value={orderData.customerRefNo} readOnly className="bg-gray-50 flex-1" />
                </div>

                {/* Date */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Date</Label>
                  <Input 
                    type="date" 
                    value={orderData.date} 
                    onChange={(e) => setOrderData({...orderData, date: e.target.value})}
                    className="flex-1" 
                  />
                </div>

                {/* Type */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Type</Label>
                  <Select value={orderData.type} onValueChange={(value) => setOrderData({...orderData, type: value})}>
                    <SelectTrigger className="flex-1">
                      <SelectValue placeholder="Select type" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="Normal Processing">Normal Processing</SelectItem>
                      <SelectItem value="Rush Processing">Rush Processing</SelectItem>
                      <SelectItem value="Premium Processing">Premium Processing</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                {/* Delivery Schedule */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Delivery Schedule</Label>
                  <Input 
                    type="datetime-local" 
                    value={orderData.deliverySchedule} 
                    onChange={(e) => setOrderData({...orderData, deliverySchedule: e.target.value})}
                    className="flex-1" 
                  />
                </div>

                {/* Status */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Status</Label>
                  <Select value={orderData.status} onValueChange={(value) => setOrderData({...orderData, status: value})}>
                    <SelectTrigger className="flex-1">
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="Created">Created</SelectItem>
                      <SelectItem value="Confirmed">Confirmed</SelectItem>
                      <SelectItem value="In Production">In Production</SelectItem>
                      <SelectItem value="Ready for Dispatch">Ready for Dispatch</SelectItem>
                      <SelectItem value="Dispatched">Dispatched</SelectItem>
                      <SelectItem value="Delivered">Delivered</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                {/* Remark */}
                <div className="flex items-start gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px] pt-2">Remark</Label>
                  <Textarea 
                    value={orderData.remark} 
                    onChange={(e) => setOrderData({...orderData, remark: e.target.value})}
                    className="flex-1" 
                    rows={3}
                  />
                </div>

                {/* Item Ref No */}
                <div className="flex items-center gap-2">
                  <Label className="text-sm font-medium text-gray-700 w-[120px]">Item Ref No</Label>
                  <Input 
                    value={orderData.itemRefNo || orderData.customerRefNo} 
                    onChange={(e) => setOrderData({...orderData, itemRefNo: e.target.value})}
                    className="flex-1" 
                  />
                </div>

                {/* Free Lens */}
                <div className="flex items-center space-x-2">
                  <Checkbox 
                    id="freeLens"
                    checked={orderData.freeLens}
                    onCheckedChange={(checked) => setOrderData({...orderData, freeLens: checked})}
                  />
                  <Label htmlFor="freeLens" className="text-sm font-medium text-gray-700">Free Lens</Label>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Right Panel - Tabbed Interface (65% width) */}
          <div className="col-span-8">
            <Card>
              <CardContent className="p-0">
                <Tabs value={activeTab} onValueChange={setActiveTab}>
                  <div className="border-b px-4 pt-4">
                    <TabsList className="grid w-full grid-cols-3 h-8">
                      <TabsTrigger value="lens-details" className="flex items-center text-xs">
                        <Eye className="h-3 w-3 mr-1" />
                        Lens Details
                      </TabsTrigger>
                      <TabsTrigger value="dispatch" className="flex items-center text-xs">
                        <Truck className="h-3 w-3 mr-1" />
                        Dispatch
                      </TabsTrigger>
                      <TabsTrigger value="billing" className="flex items-center text-xs">
                        <CreditCard className="h-3 w-3 mr-1" />
                        Billing
                      </TabsTrigger>
                    </TabsList>
                  </div>

                  <TabsContent value="lens-details" className="p-4">
                    <div className="space-y-4">
                      {/* First Row - Name and Category */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Name</Label>
                          <Select value={orderData.lensName} onValueChange={(value) => setOrderData({...orderData, lensName: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Pristine Digital ff..." />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Pristine Digital ff Progressive">Pristine Digital ff Progressive</SelectItem>
                              <SelectItem value="Essilor Varilux">Essilor Varilux</SelectItem>
                              <SelectItem value="Zeiss Progressive">Zeiss Progressive</SelectItem>
                              <SelectItem value="Standard Single Vision">Standard Single Vision</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Category</Label>
                          <Select value={orderData.category} onValueChange={(value) => setOrderData({...orderData, category: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="BiFocal" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Single Vision">Single Vision</SelectItem>
                              <SelectItem value="BiFocal">BiFocal</SelectItem>
                              <SelectItem value="Progressive">Progressive</SelectItem>
                              <SelectItem value="Reading">Reading</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>

                      {/* Second Row - Type and Dia */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Type</Label>
                          <Select value={orderData.lensType} onValueChange={(value) => setOrderData({...orderData, lensType: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Glass" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Glass">Glass</SelectItem>
                              <SelectItem value="Plastic">Plastic</SelectItem>
                              <SelectItem value="Polycarbonate">Polycarbonate</SelectItem>
                              <SelectItem value="Trivex">Trivex</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Dia</Label>
                          <Select value={orderData.dia} onValueChange={(value) => setOrderData({...orderData, dia: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="BiFocal" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="BiFocal">BiFocal</SelectItem>
                              <SelectItem value="Progressive">Progressive</SelectItem>
                              <SelectItem value="Single">Single</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>

                      {/* Third Row - Fitting Type and Coating Type */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Fitting Type</Label>
                          <Select value={orderData.fittingType} onValueChange={(value) => setOrderData({...orderData, fittingType: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Select fitting type" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Standard">Standard</SelectItem>
                              <SelectItem value="Premium">Premium</SelectItem>
                              <SelectItem value="Custom">Custom</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Coating Type</Label>
                          <Select value={orderData.coatingType} onValueChange={(value) => setOrderData({...orderData, coatingType: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Select coating type" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Anti-Reflection">Anti-Reflection</SelectItem>
                              <SelectItem value="UV Protection">UV Protection</SelectItem>
                              <SelectItem value="Blue Light">Blue Light</SelectItem>
                              <SelectItem value="Scratch Resistant">Scratch Resistant</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>

                      {/* Fourth Row - Coating Name and Tinting Name */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Coating Name</Label>
                          <Select value={orderData.coatingName} onValueChange={(value) => setOrderData({...orderData, coatingName: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="CLAIRITE" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="CLAIRITE">CLAIRITE</SelectItem>
                              <SelectItem value="CRIZAL">CRIZAL</SelectItem>
                              <SelectItem value="ULTRA">ULTRA</SelectItem>
                              <SelectItem value="PREMIUM">PREMIUM</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Tinting Name</Label>
                          <Select value={orderData.tintingName} onValueChange={(value) => setOrderData({...orderData, tintingName: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Select tinting" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Clear">Clear</SelectItem>
                              <SelectItem value="Light Brown">Light Brown</SelectItem>
                              <SelectItem value="Dark Brown">Dark Brown</SelectItem>
                              <SelectItem value="Gray">Gray</SelectItem>
                              <SelectItem value="Green">Green</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>
                      </div>

                      {/* Eye Selection */}
                      <div className="grid grid-cols-2 gap-4">
                        <div className="flex items-center space-x-2">
                          <Checkbox 
                            id="rightEye"
                            checked={orderData.rightEye}
                            onCheckedChange={(checked) => setOrderData({...orderData, rightEye: checked})}
                          />
                          <Label htmlFor="rightEye" className="text-sm font-medium text-gray-700">Right</Label>
                        </div>
                        <div className="flex items-center space-x-2">
                          <Checkbox 
                            id="leftEye"
                            checked={orderData.leftEye}
                            onCheckedChange={(checked) => setOrderData({...orderData, leftEye: checked})}
                          />
                          <Label htmlFor="leftEye" className="text-sm font-medium text-gray-700">Left</Label>
                        </div>
                      </div>

                      {/* Eye Specifications Table */}
                      <div className="mt-6">
                        <div className="grid grid-cols-9 gap-2 text-sm font-medium text-gray-700 mb-2">
                          <div></div>
                          <div>Spherical</div>
                          <div>Cylindrical</div>
                          <div>Axis</div>
                          <div>Add</div>
                          <div>Dia</div>
                          <div>Base</div>
                          <div>Base Size</div>
                          <div>BLED</div>
                        </div>
                        
                        {/* Right Eye Row */}
                        {orderData.rightEye && (
                          <div className="grid grid-cols-9 gap-2 mb-2">
                            <div className="text-sm font-medium text-gray-700 flex items-center">Right</div>
                            <Input 
                              value={orderData.rightSpherical || "-0.75"} 
                              onChange={(e) => setOrderData({...orderData, rightSpherical: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightCylindrical || "0.00"} 
                              onChange={(e) => setOrderData({...orderData, rightCylindrical: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightAxis || "0"} 
                              onChange={(e) => setOrderData({...orderData, rightAxis: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightAdd || "1.25"} 
                              onChange={(e) => setOrderData({...orderData, rightAdd: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightDia || "70"} 
                              onChange={(e) => setOrderData({...orderData, rightDia: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightBase || "RBASE"} 
                              onChange={(e) => setOrderData({...orderData, rightBase: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightBaseSize || "PRISM"} 
                              onChange={(e) => setOrderData({...orderData, rightBaseSize: e.target.value})}
                              className="h-8" 
                            />
                            <Input 
                              value={orderData.rightBled || "RNGH"} 
                              onChange={(e) => setOrderData({...orderData, rightBled: e.target.value})}
                              className="h-8" 
                            />
                          </div>
                        )}

                        {/* Left Eye Row */}
                        {orderData.leftEye && (
                          <div className="grid grid-cols-9 gap-2">
                            <div className="text-sm font-medium text-gray-700 flex items-center">Left</div>
                            <Input 
                              value={orderData.leftSpherical || ""} 
                              onChange={(e) => setOrderData({...orderData, leftSpherical: e.target.value})}
                              className="h-8" 
                              placeholder="-0.75"
                            />
                            <Input 
                              value={orderData.leftCylindrical || ""} 
                              onChange={(e) => setOrderData({...orderData, leftCylindrical: e.target.value})}
                              className="h-8" 
                              placeholder="0.00"
                            />
                            <Input 
                              value={orderData.leftAxis || ""} 
                              onChange={(e) => setOrderData({...orderData, leftAxis: e.target.value})}
                              className="h-8" 
                              placeholder="0"
                            />
                            <Input 
                              value={orderData.leftAdd || ""} 
                              onChange={(e) => setOrderData({...orderData, leftAdd: e.target.value})}
                              className="h-8" 
                              placeholder="1.25"
                            />
                            <Input 
                              value={orderData.leftDia || ""} 
                              onChange={(e) => setOrderData({...orderData, leftDia: e.target.value})}
                              className="h-8" 
                              placeholder="70"
                            />
                            <Input 
                              value={orderData.leftBase || ""} 
                              onChange={(e) => setOrderData({...orderData, leftBase: e.target.value})}
                              className="h-8" 
                              placeholder="RBASE"
                            />
                            <Input 
                              value={orderData.leftBaseSize || ""} 
                              onChange={(e) => setOrderData({...orderData, leftBaseSize: e.target.value})}
                              className="h-8" 
                              placeholder="PRISM"
                            />
                            <Input 
                              value={orderData.leftBled || ""} 
                              onChange={(e) => setOrderData({...orderData, leftBled: e.target.value})}
                              className="h-8" 
                              placeholder="RNGH"
                            />
                          </div>
                        )}
                      </div>
                    </div>
                  </TabsContent>

                  <TabsContent value="dispatch" className="p-4">
                    <div className="grid grid-cols-2 gap-6">
                      <div className="space-y-4">
                        <h4 className="font-medium text-gray-900 flex items-center">
                          <MapPin className="h-4 w-4 mr-2" />
                          Dispatch Information
                        </h4>
                        
                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Dispatch Status</Label>
                          <Select value={orderData.dispatchStatus} onValueChange={(value) => setOrderData({...orderData, dispatchStatus: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Pending" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="Pending">Pending</SelectItem>
                              <SelectItem value="Assigned">Assigned</SelectItem>
                              <SelectItem value="In Transit">In Transit</SelectItem>
                              <SelectItem value="Delivered">Delivered</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Assigned Person</Label>
                          <Select value={orderData.assignedPerson} onValueChange={(value) => setOrderData({...orderData, assignedPerson: value})}>
                            <SelectTrigger className="flex-1">
                              <SelectValue placeholder="Select dispatch person" />
                            </SelectTrigger>
                            <SelectContent>
                              <SelectItem value="John Doe">John Doe</SelectItem>
                              <SelectItem value="Jane Smith">Jane Smith</SelectItem>
                              <SelectItem value="Mike Johnson">Mike Johnson</SelectItem>
                              <SelectItem value="Sarah Wilson">Sarah Wilson</SelectItem>
                            </SelectContent>
                          </Select>
                        </div>

                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Dispatch ID</Label>
                          <Input 
                            value={orderData.dispatchId} 
                            onChange={(e) => setOrderData({...orderData, dispatchId: e.target.value})}
                            placeholder="Auto-generated or manual ID"
                            className="flex-1" 
                          />
                        </div>
                      </div>

                      <div className="space-y-4">
                        <h4 className="font-medium text-gray-900 flex items-center">
                          <Clock className="h-4 w-4 mr-2" />
                          Schedule & Timing
                        </h4>
                        
                        <div className="grid grid-cols-2 gap-3">
                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Estimated Date</Label>
                            <Input 
                              type="date" 
                              value={orderData.estimatedDate} 
                              onChange={(e) => setOrderData({...orderData, estimatedDate: e.target.value})}
                              className="flex-1" 
                            />
                          </div>
                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Estimated Time</Label>
                            <Input 
                              type="time" 
                              value={orderData.estimatedTime} 
                              onChange={(e) => setOrderData({...orderData, estimatedTime: e.target.value})}
                              className="flex-1" 
                            />
                          </div>
                        </div>

                        <div className="grid grid-cols-2 gap-3">
                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Actual Date</Label>
                            <Input 
                              type="date" 
                              value={orderData.actualDate} 
                              onChange={(e) => setOrderData({...orderData, actualDate: e.target.value})}
                              className="flex-1" 
                            />
                          </div>
                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Actual Time</Label>
                            <Input 
                              type="time" 
                              value={orderData.actualTime} 
                              onChange={(e) => setOrderData({...orderData, actualTime: e.target.value})}
                              className="flex-1" 
                            />
                          </div>
                        </div>

                        <div className="flex items-start gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px] pt-2">Dispatch Notes</Label>
                          <Textarea 
                            value={orderData.dispatchNotes} 
                            onChange={(e) => setOrderData({...orderData, dispatchNotes: e.target.value})}
                            placeholder="Special delivery instructions"
                            className="flex-1" 
                            rows={3}
                          />
                        </div>
                      </div>
                    </div>
                  </TabsContent>

                  <TabsContent value="billing" className="p-4">
                    <div className="grid grid-cols-2 gap-6">
                      <div className="space-y-4">
                        <h4 className="font-medium text-gray-900 flex items-center">
                          <DollarSign className="h-4 w-4 mr-2" />
                          Pricing Details
                        </h4>
                        
                        <div className="grid grid-cols-2 gap-3">
                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Lens Price</Label>
                            <Input 
                              type="number" 
                              step="0.01"
                              value={orderData.lensPrice} 
                              onChange={(e) => setOrderData({...orderData, lensPrice: parseFloat(e.target.value) || 0})}
                              className="flex-1" 
                              placeholder="0.00"
                            />
                          </div>

                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Coating Price</Label>
                            <Input 
                              type="number" 
                              step="0.01"
                              value={orderData.coatingPrice} 
                              onChange={(e) => setOrderData({...orderData, coatingPrice: parseFloat(e.target.value) || 0})}
                              className="flex-1" 
                              placeholder="0.00"
                            />
                          </div>

                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Fitting Price</Label>
                            <Input 
                              type="number" 
                              step="0.01"
                              value={orderData.fittingPrice} 
                              onChange={(e) => setOrderData({...orderData, fittingPrice: parseFloat(e.target.value) || 0})}
                              className="flex-1" 
                              placeholder="0.00"
                            />
                          </div>

                          <div className="flex items-center gap-2">
                            <Label className="text-sm font-medium text-gray-700 w-[120px]">Tinting Price</Label>
                            <Input 
                              type="number" 
                              step="0.01"
                              value={orderData.tintingPrice} 
                              onChange={(e) => setOrderData({...orderData, tintingPrice: parseFloat(e.target.value) || 0})}
                              className="flex-1" 
                              placeholder="0.00"
                            />
                          </div>
                        </div>

                        <div className="flex items-center gap-2">
                          <Label className="text-sm font-medium text-gray-700 w-[120px]">Customer Discount (%)</Label>
                          <Input 
                            type="number" 
                            min="0" 
                            max="100" 
                            step="0.1"
                            value={orderData.discount} 
                            onChange={(e) => setOrderData({...orderData, discount: parseFloat(e.target.value) || 0})}
                            className="flex-1" 
                            placeholder="0"
                          />
                        </div>
                      </div>

                      <div className="space-y-4">
                        <h4 className="font-medium text-gray-900">Billing Summary</h4>
                        
                        <Card className="bg-gray-50">
                          <CardContent className="p-4 space-y-3">
                            <div className="flex justify-between text-sm">
                              <span>Subtotal:</span>
                              <span>₹{((orderData.lensPrice || 0) + (orderData.coatingPrice || 0) + (orderData.fittingPrice || 0) + (orderData.tintingPrice || 0)).toLocaleString("en-IN", {minimumFractionDigits: 2})}</span>
                            </div>
                            
                            {orderData.discount > 0 && (
                              <div className="flex justify-between text-sm text-red-600">
                                <span>Discount ({orderData.discount}%):</span>
                                <span>-₹{(((orderData.lensPrice || 0) + (orderData.coatingPrice || 0) + (orderData.fittingPrice || 0) + (orderData.tintingPrice || 0)) * (orderData.discount || 0) / 100).toLocaleString("en-IN", {minimumFractionDigits: 2})}</span>
                              </div>
                            )}
                            
                            <div className="flex justify-between text-sm">
                              <span>After Discount:</span>
                              <span>₹{(((orderData.lensPrice || 0) + (orderData.coatingPrice || 0) + (orderData.fittingPrice || 0) + (orderData.tintingPrice || 0)) * (1 - (orderData.discount || 0) / 100)).toLocaleString("en-IN", {minimumFractionDigits: 2})}</span>
                            </div>
                            
                            <div className="flex justify-between text-sm">
                              <span>GST (18%):</span>
                              <span>₹{(((orderData.lensPrice || 0) + (orderData.coatingPrice || 0) + (orderData.fittingPrice || 0) + (orderData.tintingPrice || 0)) * (1 - (orderData.discount || 0) / 100) * 0.18).toLocaleString("en-IN", {minimumFractionDigits: 2})}</span>
                            </div>
                            
                            <Separator />
                            
                            <div className="flex justify-between font-semibold">
                              <span>Total Amount:</span>
                              <span className="text-green-600">₹{(((orderData.lensPrice || 0) + (orderData.coatingPrice || 0) + (orderData.fittingPrice || 0) + (orderData.tintingPrice || 0)) * (1 - (orderData.discount || 0) / 100) * 1.18).toLocaleString("en-IN", {minimumFractionDigits: 2})}</span>
                            </div>
                          </CardContent>
                        </Card>
                      </div>
                    </div>
                  </TabsContent>
                </Tabs>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </div>
  );
};

export default SaleOrderForm;